<%- include('./header') %>
<p>Customer Delete Page</p>
    <div class="container mt-4">
    <h1><%= title %></h1> <%# This should be 'Customers' or 'Customer List' from controller %>

    <%# Optional: Add Search and Filter Forms here later %>

    <div class="table-responsive mb-3">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Company</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <% if (customers && customers.length > 0) { %>
                    <% customers.forEach(customer => { %>
                        <tr>
                            <td><%= customer.name %></td>
                            <td><%= customer.email %></td>
                            <td><%= customer.company || '-' %></td>
                            <td><%= customer.status ? customer.status.charAt(0).toUpperCase() + customer.status.slice(1) : '-' %></td>
                            <td>
 
                                <a href="./detail/<%=customer._id%>"><%= customer.name%></a>
                                <a href="./confirmation/<%=customer._id%>">Delete</a>
                                <%# Add delete button/form later %>
                            </td>
                        </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="5" class="text-center">No customers found.</td>
                    </tr>
                <% } %>
            </tbody>
        </table>
    </div>
    


     <%# --- PAGINATION CONTROLS --- %>
    <% if (typeof totalPages !== 'undefined' && totalPages > 1) { %>
        <nav aria-label="Customer Pagination">
            <ul class="pagination justify-content-center">
                <%# "Previous" page link %>
                <% if (currentPage > 1) { %>
                    <li class="page-item">
                        <%# Construct query string, ensuring all existing filters/sorts are preserved %>
                        <a class="page-link" href="/customer/home?page=<%= currentPage - 1 %>&search=<%= searchQuery || '' %>&status=<%= currentStatus || '' %>&sortBy=<%= currentSortBy || 'createdAt' %>&sortOrder=<%= currentSortOrder || 'desc' %>">Previous</a>
                    </li>
                <% } else { %>
                    <li class="page-item disabled">
                        <span class="page-link">Previous</span>
                    </li>
                <% } %>

                <%# Page number links (simple example) %>
                <% for (let i = 1; i <= totalPages; i++) { %>
                    <% if (i === currentPage) { %>
                        <li class="page-item active" aria-current="page">
                            <span class="page-link"><%= i %></span>
                        </li>
                    <% } else { %>
                        <li class="page-item">
                            <a class="page-link" href="/customer/home?page=<%= i %>&search=<%= searchQuery || '' %>&status=<%= currentStatus || '' %>&sortBy=<%= currentSortBy || 'createdAt' %>&sortOrder=<%= currentSortOrder || 'desc' %>"><%= i %></a>
                        </li>
                    <% } %>
                <% } %>

                <%# "Next" page link %>
                <% if (currentPage < totalPages) { %>
                    <li class="page-item">
                        <a class="page-link" href="/customer/home?page=<%= currentPage + 1 %>&search=<%= searchQuery || '' %>&status=<%= currentStatus || '' %>&sortBy=<%= currentSortBy || 'createdAt' %>&sortOrder=<%= currentSortOrder || 'desc' %>">Next</a>
                    </li>
                <% } else { %>
                    <li class="page-item disabled">
                        <span class="page-link">Next</span>
                    </li>
                <% } %>
            </ul>
        </nav>
        <p class="text-center">Page <%= currentPage %> of <%= totalPages %> (Total Customers: <%= typeof totalCustomers !== 'undefined' ? totalCustomers : 'N/A' %>)</p>
    <% } else if (typeof totalCustomers !== 'undefined' && totalCustomers > 0) { %>
        <p class="text-center">Total Customers: <%= totalCustomers %></p>
    <% } %>
    
    <div class="mt-3">
        <a href="/customer/create" class="btn btn-success">Add New Customer</a>
    </div>

</div>
<%- include('../partials/footer') %>